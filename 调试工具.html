<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIå¯¹è¯ç›‘æ§åŠ©æ‰‹ - è°ƒè¯•å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .section h2 {
            color: #2196f3;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .step {
            background: #f9f9f9;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #2196f3;
            border-radius: 4px;
        }
        
        .step-number {
            display: inline-block;
            background: #2196f3;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            text-align: center;
            line-height: 24px;
            font-weight: bold;
            margin-right: 10px;
            font-size: 12px;
        }
        
        .code-block {
            background: #263238;
            color: #aed581;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            margin: 10px 0;
            overflow-x: auto;
        }
        
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .status.success {
            background: #e8f5e9;
            color: #2e7d32;
            border-left: 4px solid #4caf50;
        }
        
        .status.error {
            background: #ffebee;
            color: #c62828;
            border-left: 4px solid #f44336;
        }
        
        .status.info {
            background: #e3f2fd;
            color: #1565c0;
            border-left: 4px solid #2196f3;
        }
        
        .btn {
            background: #2196f3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        
        .btn:hover {
            background: #1976d2;
        }
        
        .btn-secondary {
            background: #f5f5f5;
            color: #333;
        }
        
        .btn-secondary:hover {
            background: #e0e0e0;
        }
        
        .log-area {
            background: #263238;
            color: #aed581;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 10px;
        }
        
        .log-entry {
            margin: 5px 0;
            padding: 5px;
        }
        
        .log-entry.error {
            color: #f44336;
        }
        
        .log-entry.success {
            color: #4caf50;
        }
        
        .log-entry.info {
            color: #2196f3;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ” AIå¯¹è¯ç›‘æ§åŠ©æ‰‹ - è°ƒè¯•å·¥å…·</h1>
        <p>å¸®åŠ©æ‚¨è¯Šæ–­æ’ä»¶å·¥ä½œçŠ¶æ€å’Œé—®é¢˜</p>
    </div>
    
    <div class="section">
        <h2>ğŸ“‹ å¿«é€Ÿæ£€æŸ¥æ¸…å•</h2>
        
        <div class="step">
            <span class="step-number">1</span>
            <strong>ç¡®è®¤æ’ä»¶å·²å®‰è£…</strong>
            <p>åœ¨æµè§ˆå™¨ä¸­è®¿é—® <code>chrome://extensions/</code>ï¼Œç¡®è®¤"AIå¯¹è¯ç›‘æ§åŠ©æ‰‹"å·²å¯ç”¨</p>
        </div>
        
        <div class="step">
            <span class="step-number">2</span>
            <strong>è®¿é—®AIå¹³å°</strong>
            <p>æ‰“å¼€ä»¥ä¸‹ä»»ä¸€å¹³å°ï¼š</p>
            <ul style="margin-left: 30px; margin-top: 10px;">
                <li><a href="https://chat.openai.com" target="_blank">ChatGPT</a>ï¼ˆæ¨èï¼Œæœ€ç¨³å®šï¼‰</li>
                <li><a href="https://gemini.google.com" target="_blank">Gemini</a></li>
                <li><a href="https://claude.ai" target="_blank">Claude</a></li>
            </ul>
        </div>
        
        <div class="step">
            <span class="step-number">3</span>
            <strong>æ‰“å¼€å¼€å‘è€…å·¥å…·</strong>
            <p>æŒ‰ <code>F12</code> æˆ–å³é”® â†’ æ£€æŸ¥ï¼Œæ‰“å¼€å¼€å‘è€…å·¥å…·</p>
        </div>
        
        <div class="step">
            <span class="step-number">4</span>
            <strong>æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—</strong>
            <p>åˆ‡æ¢åˆ°"Console"æ ‡ç­¾ï¼Œåº”è¯¥èƒ½çœ‹åˆ°ä»¥ä¸‹æ—¥å¿—ï¼š</p>
            <div class="code-block">
AIå¯¹è¯ç›‘æ§åŠ©æ‰‹ - Content Script å·²åŠ è½½
æ£€æµ‹åˆ°å¹³å°: gemini (æˆ– chatgpt/claude)
å¼€å§‹ç›‘æ§å¹³å°: gemini
            </div>
        </div>
        
        <div class="step">
            <span class="step-number">5</span>
            <strong>å‘é€æµ‹è¯•æ¶ˆæ¯</strong>
            <p>åœ¨AIå¹³å°ä¸Šå‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œç­‰å¾…AIå›å¤ã€‚æ§åˆ¶å°åº”è¯¥æ˜¾ç¤ºï¼š</p>
            <div class="code-block">
æ¶ˆæ¯å·²ä¿å­˜: user [æ‚¨çš„æ¶ˆæ¯]
æ¶ˆæ¯å·²ä¿å­˜: assistant [AIçš„å›å¤]
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>ğŸ”§ å¸¸è§é—®é¢˜è¯Šæ–­</h2>
        
        <div class="status error">
            <strong>é—®é¢˜1ï¼šçœ‹ä¸åˆ°"Content Script å·²åŠ è½½"æ—¥å¿—</strong>
            <p>â€¢ åˆ·æ–°é¡µé¢ï¼ˆCtrl+R æˆ– F5ï¼‰</p>
            <p>â€¢ æ£€æŸ¥æ’ä»¶æ˜¯å¦åœ¨æ‰©å±•ç®¡ç†é¡µé¢ä¸­å¯ç”¨</p>
            <p>â€¢ ç¡®è®¤å½“å‰é¡µé¢æ˜¯æ”¯æŒçš„AIå¹³å°</p>
        </div>
        
        <div class="status error">
            <strong>é—®é¢˜2ï¼šçœ‹åˆ°"æ£€æµ‹åˆ°å¹³å°"ä½†æ²¡æœ‰"å¼€å§‹ç›‘æ§"</strong>
            <p>â€¢ æ£€æŸ¥æ’ä»¶è®¾ç½®ä¸­æ˜¯å¦å¯ç”¨äº†å¯¹åº”å¹³å°</p>
            <p>â€¢ å³é”®æ’ä»¶å›¾æ ‡ â†’ é€‰é¡¹ â†’ æ£€æŸ¥å¹³å°è®¾ç½®</p>
        </div>
        
        <div class="status error">
            <strong>é—®é¢˜3ï¼šçœ‹åˆ°"å¼€å§‹ç›‘æ§"ä½†æ²¡æœ‰"æ¶ˆæ¯å·²ä¿å­˜"</strong>
            <p>â€¢ è¿™æ˜¯æœ€å¸¸è§çš„é—®é¢˜ï¼Œè¯´æ˜é¡µé¢ç»“æ„ä¸åŒ¹é…</p>
            <p>â€¢ éœ€è¦æ›´æ–°é€‚é…å™¨çš„é€‰æ‹©å™¨</p>
            <p>â€¢ è¯·å‘Šè¯‰æˆ‘æ‚¨çœ‹åˆ°çš„æ§åˆ¶å°æ—¥å¿—ï¼Œæˆ‘å¯ä»¥å¸®æ‚¨ä¿®å¤</p>
        </div>
        
        <div class="status info">
            <strong>é—®é¢˜4ï¼šGeminiæ— æ³•è®°å½•</strong>
            <p>â€¢ Geminiçš„é¡µé¢ç»“æ„ç»å¸¸å˜åŒ–</p>
            <p>â€¢ å»ºè®®å…ˆç”¨ChatGPTæµ‹è¯•ï¼Œç¡®è®¤æ’ä»¶æœ¬èº«å·¥ä½œæ­£å¸¸</p>
            <p>â€¢ å¦‚æœChatGPTå¯ä»¥è®°å½•ï¼Œè¯´æ˜æ’ä»¶æ­£å¸¸ï¼Œåªæ˜¯Geminié€‚é…å™¨éœ€è¦æ›´æ–°</p>
        </div>
    </div>
    
    <div class="section">
        <h2>ğŸ’¡ æ‰‹åŠ¨æµ‹è¯•æ–¹æ³•</h2>
        
        <p>åœ¨AIå¹³å°çš„å¼€å‘è€…å·¥å…·æ§åˆ¶å°ä¸­ï¼Œè¿è¡Œä»¥ä¸‹ä»£ç æ¥æµ‹è¯•ï¼š</p>
        
        <div class="code-block">
// æµ‹è¯•1ï¼šæ£€æŸ¥æ’ä»¶æ˜¯å¦åŠ è½½
console.log('æ’ä»¶çŠ¶æ€:', typeof ChatGPTAdapter !== 'undefined' ? 'å·²åŠ è½½' : 'æœªåŠ è½½');

// æµ‹è¯•2ï¼šæŸ¥æ‰¾æ¶ˆæ¯å…ƒç´ ï¼ˆGeminiç¤ºä¾‹ï¼‰
const messages = document.querySelectorAll('[class*="message"], [data-message], article, div[role="listitem"]');
console.log('æ‰¾åˆ°', messages.length, 'ä¸ªå¯èƒ½çš„æ¶ˆæ¯å…ƒç´ ');
messages.forEach((msg, i) => {
    const text = msg.textContent || msg.innerText || '';
    if (text.length > 20) {
        console.log(`æ¶ˆæ¯${i}:`, text.substring(0, 100));
    }
});

// æµ‹è¯•3ï¼šæ£€æŸ¥å­˜å‚¨
chrome.storage.local.get(null, (items) => {
    const messageKeys = Object.keys(items).filter(k => k.startsWith('messages_'));
    console.log('å­˜å‚¨çš„æ¶ˆæ¯é”®:', messageKeys);
    if (messageKeys.length > 0) {
        const today = new Date().toISOString().split('T')[0];
        const todayKey = `messages_${today}`;
        console.log('ä»Šæ—¥æ¶ˆæ¯æ•°:', items[todayKey]?.length || 0);
    }
});
        </div>
        
        <button class="btn" onclick="copyTestCode()">ğŸ“‹ å¤åˆ¶æµ‹è¯•ä»£ç </button>
    </div>
    
    <div class="section">
        <h2>ğŸ“Š æ£€æŸ¥å­˜å‚¨çš„æ•°æ®</h2>
        
        <button class="btn" onclick="checkStorage()">æ£€æŸ¥å­˜å‚¨æ•°æ®</button>
        <button class="btn btn-secondary" onclick="clearStorage()">æ¸…é™¤æµ‹è¯•æ•°æ®</button>
        
        <div id="storageInfo" class="log-area" style="display: none;"></div>
    </div>
    
    <div class="section">
        <h2>âœ… æ¨èæµ‹è¯•æµç¨‹</h2>
        
        <ol style="margin-left: 20px; line-height: 2;">
            <li><strong>å…ˆç”¨ChatGPTæµ‹è¯•</strong> - ChatGPTçš„é€‚é…æœ€ç¨³å®š</li>
            <li><strong>ç¡®è®¤æ’ä»¶æ­£å¸¸å·¥ä½œ</strong> - å¦‚æœèƒ½è®°å½•ChatGPTçš„å¯¹è¯ï¼Œè¯´æ˜æ’ä»¶æœ¬èº«æ²¡é—®é¢˜</li>
            <li><strong>å†æµ‹è¯•å…¶ä»–å¹³å°</strong> - å¦‚æœGeminiä¸è¡Œï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·è°ƒè¯•</li>
            <li><strong>æŸ¥çœ‹popupç»Ÿè®¡</strong> - ç‚¹å‡»æ’ä»¶å›¾æ ‡ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰æ•°æ®</li>
            <li><strong>ç”Ÿæˆæ€»ç»“</strong> - æµ‹è¯•æ€»ç»“åŠŸèƒ½æ˜¯å¦æ­£å¸¸</li>
        </ol>
    </div>
    
    <script>
        function copyTestCode() {
            const code = `// æµ‹è¯•æ’ä»¶çŠ¶æ€
console.log('æ’ä»¶çŠ¶æ€:', typeof ChatGPTAdapter !== 'undefined' ? 'å·²åŠ è½½' : 'æœªåŠ è½½');

// æŸ¥æ‰¾æ¶ˆæ¯å…ƒç´ 
const messages = document.querySelectorAll('[class*="message"], [data-message], article, div[role="listitem"]');
console.log('æ‰¾åˆ°', messages.length, 'ä¸ªå¯èƒ½çš„æ¶ˆæ¯å…ƒç´ ');
messages.forEach((msg, i) => {
    const text = msg.textContent || msg.innerText || '';
    if (text.length > 20) {
        console.log(\`æ¶ˆæ¯\${i}:\`, text.substring(0, 100));
    }
});

// æ£€æŸ¥å­˜å‚¨
chrome.storage.local.get(null, (items) => {
    const messageKeys = Object.keys(items).filter(k => k.startsWith('messages_'));
    console.log('å­˜å‚¨çš„æ¶ˆæ¯é”®:', messageKeys);
    if (messageKeys.length > 0) {
        const today = new Date().toISOString().split('T')[0];
        const todayKey = \`messages_\${today}\`;
        console.log('ä»Šæ—¥æ¶ˆæ¯æ•°:', items[todayKey]?.length || 0);
    }
});`;
            
            navigator.clipboard.writeText(code).then(() => {
                alert('æµ‹è¯•ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼\n\nè¯·åœ¨AIå¹³å°çš„å¼€å‘è€…å·¥å…·æ§åˆ¶å°ä¸­ç²˜è´´è¿è¡Œã€‚');
            });
        }
        
        function checkStorage() {
            if (typeof chrome === 'undefined' || !chrome.storage) {
                document.getElementById('storageInfo').innerHTML = 
                    '<div class="log-entry error">âŒ æ— æ³•è®¿é—®Chrome Storage APIï¼ˆè¯·åœ¨æ‰©å±•é¡µé¢ä¸­æ‰“å¼€æ­¤å·¥å…·ï¼‰</div>';
                document.getElementById('storageInfo').style.display = 'block';
                return;
            }
            
            chrome.storage.local.get(null, (items) => {
                const messageKeys = Object.keys(items).filter(k => k.startsWith('messages_'));
                let html = '';
                
                if (messageKeys.length === 0) {
                    html = '<div class="log-entry info">ğŸ“­ æš‚æ— å­˜å‚¨çš„æ¶ˆæ¯æ•°æ®</div>';
                } else {
                    html += `<div class="log-entry success">âœ… æ‰¾åˆ° ${messageKeys.length} ä¸ªæ—¥æœŸçš„æ•°æ®</div>`;
                    
                    messageKeys.forEach(key => {
                        const messages = items[key] || [];
                        const date = key.replace('messages_', '');
                        html += `<div class="log-entry">ğŸ“… ${date}: ${messages.length} æ¡æ¶ˆæ¯</div>`;
                        
                        if (messages.length > 0) {
                            messages.slice(0, 3).forEach((msg, i) => {
                                html += `<div class="log-entry" style="margin-left: 20px;">
                                    ${i + 1}. [${msg.role}] ${msg.content.substring(0, 50)}...
                                </div>`;
                            });
                        }
                    });
                }
                
                document.getElementById('storageInfo').innerHTML = html;
                document.getElementById('storageInfo').style.display = 'block';
            });
        }
        
        function clearStorage() {
            if (confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰æµ‹è¯•æ•°æ®å—ï¼Ÿ')) {
                chrome.storage.local.get(null, (items) => {
                    const keysToRemove = Object.keys(items).filter(k => k.startsWith('messages_'));
                    chrome.storage.local.remove(keysToRemove, () => {
                        alert('æµ‹è¯•æ•°æ®å·²æ¸…é™¤ï¼');
                        checkStorage();
                    });
                });
            }
        }
    </script>
</body>
</html>

